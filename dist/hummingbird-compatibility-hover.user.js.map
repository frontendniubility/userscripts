{"version":3,"file":"hummingbird-compatibility-hover.user.js","mappings":"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","sources":["webpack://userscripts/./src/hummingbird-compatibility-hover/hummingbird-compatibility-hover.user.js"],"sourcesContent":["// ==UserScript==\r\n// @name         Hummingbird Compatibility Hover\r\n// @namespace    http://fuzetsu.com/hch\r\n// @version      1.0.4\r\n// @description  Shows hummingbird user compatibility rating at the bottom right of the screen when a user link is hovered over\r\n// @author       fuzetsu\r\n// @match        *://hummingbird.me/*\r\n// @match        *://forums.hummingbird.me/*\r\n// @grant        none\r\n// @require      https://greasyfork.org/scripts/5679-wait-for-elements/code/Wait%20For%20Elements.js?1\r\n// @deprecated   true\r\n// ==/UserScript==\r\n\r\nvar SCRIPT_NAME = 'Hummingbird Compatibility Hover';\r\nvar COMPAT_ID = 'hb-compat-area';\r\nvar LOAD_GIF = 'https://i.imgur.com/gX1lY9z.gif';\r\nvar DELAY_SEC = 0.75;\r\nvar CACHED = {};\r\n\r\nvar Util = {\r\n  log: function() {\r\n    var args = [].slice.call(arguments);\r\n    args.unshift('%c' + SCRIPT_NAME + ':', 'font-weight: bold;color: #233c7b;');\r\n    console.log.apply(console, args);\r\n  },\r\n  q: function(query, context) {\r\n    return (context || document).querySelector(query);\r\n  },\r\n  qq: function(query, context) {\r\n    return [].slice.call((context || document).querySelectorAll(query));\r\n  },\r\n  getJSON: function(url, load, error) {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.open('get', url);\r\n    xhr.responseType = 'json';\r\n    xhr.onload = function() {\r\n      load(xhr.response);\r\n    };\r\n    xhr.onerror = error;\r\n    xhr.send();\r\n  },\r\n  _style: document.head.appendChild(document.createElement('style')),\r\n  addStyle: function(styles) {\r\n    var sel, css, obj;\r\n    var out = '';\r\n    for (sel in styles) {\r\n      obj = styles[sel];\r\n      out += sel + '{';\r\n      for (css in obj) {\r\n        out += css + ':' + obj[css] + ';';\r\n      }\r\n      out += '}';\r\n    }\r\n    this._style.textContent += out;\r\n  }\r\n};\r\n\r\nvar hb = {\r\n  getUserName: function(url) {\r\n    return url.match(/\\/users\\/([a-z0-9_]+)/i)[1];\r\n  }\r\n};\r\n\r\nvar App = {\r\n  userLinkRegex: /^https?:\\/\\/(forums\\.)?hummingbird\\.me\\/users\\/[^\\/]+\\/?(\\?.*)?$/,\r\n\r\n  styleUI: function() {\r\n    var style = {\r\n      '.hb-visible': {\r\n        'visibility': 'visible',\r\n        'opacity': 1,\r\n        'transition': 'opacity .5s linear'\r\n      },\r\n      '.hb-hidden': {\r\n        'visibility': 'hidden',\r\n        'opacity': 0,\r\n        'transition': 'visibility 0s .5s, opacity .5s linear'\r\n      },\r\n      '.hb-compat-percent': {\r\n        'font-size': '32px',\r\n        'font-weight': 'bold',\r\n        'margin': '5px 10px 10px 10px'\r\n      },\r\n      '.hb-compat-header': {\r\n        'font-size': '24px',\r\n        'margin': '20px 10px 10px 10px'\r\n      }\r\n    };\r\n    var id = '#' + COMPAT_ID;\r\n    style[id] = {\r\n      'font-family': '\"Helvetica Neue\", Helvetica, Arial, \"Lucida Grande\", sans-serif',\r\n      'position': 'fixed',\r\n      'background': 'white',\r\n      'text-align': 'center',\r\n      'box-shadow': '0px 0px 15px 0px rgba(0,0,0,0.75)',\r\n      'border-top-left-radius': '5px',\r\n      'max-width': '90%',\r\n      'bottom': '0',\r\n      'right': '0',\r\n      'z-index': '10000',\r\n      'line-height': '32px'\r\n    };\r\n    style[id + ' img'] = {\r\n      'margin': '20px 50px 20px 50px'\r\n    };\r\n    Util.addStyle(style);\r\n  },\r\n\r\n  getCompatArea: function() {\r\n    var compatArea = Util.q('#' + COMPAT_ID);\r\n\r\n    if (!compatArea) {\r\n      compatArea = document.createElement('div');\r\n      compatArea.id = COMPAT_ID;\r\n      compatArea.style.display = 'none';\r\n      document.body.appendChild(compatArea);\r\n    }\r\n\r\n    return compatArea;\r\n  },\r\n\r\n  getCompatHTML: function(compat) {\r\n    return '<h3 class=\"hb-compat-header\">Compatibility is ' + compat.phrase + '</h3><div class=\"hb-compat-percent\" style=\"color: ' + compat.color + '\">' + compat.percent + '</div>';\r\n  },\r\n\r\n  showCompat: function(me, them) {\r\n    if (me === them) return;\r\n    if (Util.q('.signup-cta')) return; // not signed in\r\n\r\n    var self = this;\r\n    var area = this.getCompatArea();\r\n\r\n    var cache = CACHED[me + '+' + them];\r\n    if (cache) {\r\n      area.innerHTML = self.getCompatHTML(cache);\r\n    } else {\r\n      area.innerHTML = '<img src=\"' + LOAD_GIF + '\" />';\r\n      Util.getJSON('https://hbird-cmp-node.herokuapp.com/compatibility/anime?user1=' + me + '&user2=' + them, function(compat) {\r\n        CACHED[me + '+' + them] = compat;\r\n        area.innerHTML = self.getCompatHTML(compat);\r\n      });\r\n    }\r\n    area.style.display = '';\r\n    setTimeout(function() {\r\n      area.className = 'hb-visible';\r\n    }, 0);\r\n  },\r\n\r\n  hideCompat: function() {\r\n    var area = this.getCompatArea();\r\n    area.className = 'hb-hidden';\r\n    setTimeout(function() {\r\n      area.style.display = 'none';\r\n    }, 500);\r\n  },\r\n\r\n  _timeout: null,\r\n  startHover: function(e) {\r\n    App._timeout = setTimeout(function() {\r\n      App._timeout = null;\r\n      App.showCompat(hb.getUserName(Util.q('.dropdown-menu > li > a, #current-user > a').href), hb.getUserName(e.target.href));\r\n    }, DELAY_SEC * 1000);\r\n  },\r\n  stopHover: function(e) {\r\n    clearInterval(App._timeout);\r\n    App.hideCompat();\r\n  },\r\n\r\n  start: function() {\r\n    var self = this;\r\n    Util.log('starting...');\r\n    self.styleUI();\r\n    waitForElems('a', function(link) {\r\n      if (self.userLinkRegex.test(link.href)) {\r\n        link.addEventListener('mouseenter', self.startHover);\r\n        link.addEventListener('mouseleave', self.stopHover);\r\n        link.addEventListener('click', self.stopHover);\r\n      }\r\n    });\r\n  }\r\n\r\n};\r\n\r\nApp.start();\r\n"],"names":["SCRIPT_NAME","COMPAT_ID","CACHED","Util","log","args","slice","call","arguments","unshift","console","apply","q","query","context","document","querySelector","qq","querySelectorAll","getJSON","url","load","error","xhr","XMLHttpRequest","open","responseType","onload","response","onerror","send","_style","head","appendChild","createElement","addStyle","styles","sel","css","obj","out","this","textContent","hb","match","App","userLinkRegex","styleUI","style","id","getCompatArea","compatArea","display","body","getCompatHTML","compat","phrase","color","percent","showCompat","me","them","self","area","cache","innerHTML","setTimeout","className","hideCompat","_timeout","startHover","e","href","target","DELAY_SEC","stopHover","clearInterval","start","waitForElems","link","test","addEventListener"],"sourceRoot":""}