{"version":3,"file":"youtube-playlist-search.user.js","mappings":"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","sources":["webpack://userscripts/./src/youtube-playlist-search/youtube-playlist-search.user.js"],"sourcesContent":["// ==UserScript==\r\n// @name         YouTube Playlist Search\r\n// @namespace    http://www.fuzetsu.com/YPS\r\n// @version      1.1.3\r\n// @description  Allows you to quickly search through youtube playlists\r\n// @match        https://www.youtube.com/*\r\n// @require      https://cdn.rawgit.com/fuzetsu/userscripts/477063e939b9658b64d2f91878da20a7f831d98b/wait-for-elements/wait-for-elements.js\r\n// @copyright    2014+, fuzetsu\r\n// @grant        none\r\n// ==/UserScript==\r\n\r\nconst SCRIPT_NAME = 'YouTube Playlist Search';\r\nconst ITEM_SELECTOR = '#contents > ytd-playlist-video-renderer,ytd-grid-video-renderer';\r\nconst ITEM_PROGRESS_SELECTOR = ITEM_SELECTOR + ' #progress';\r\nconst TEXT_SELECTOR = '#meta';\r\nconst OFFSET_AREA_SELECTOR = '#masthead-container';\r\n\r\nconst util = {\r\n  log: (...args) => console.log(`%c${SCRIPT_NAME}`, 'font-weight: bold;color: hotpink;', ...args),\r\n  q: (query, context) => (context || document).querySelector(query),\r\n  qq: (query, context) => Array.from((context || document).querySelectorAll(query)),\r\n  debounce: (cb, ms) => {\r\n    let id;\r\n    return (...args) => {\r\n      clearTimeout(id);\r\n      id = setTimeout(() => cb(...args), ms);\r\n    };\r\n  },\r\n  makeElem: (tag, attrs) => {\r\n    const elem = document.createElement(tag);\r\n    Object.entries(attrs).forEach(([attr, val]) => !['style'].includes(attr) && attr in elem ? elem[attr] = val : elem.setAttribute(attr, val));\r\n    return elem;\r\n  }\r\n};\r\n\r\nconst yps = {\r\n  _items: [],\r\n  hideWatched: false,\r\n  render: () => {\r\n    const commonStyles = [\r\n      'position: fixed',\r\n      `top: ${util.q(OFFSET_AREA_SELECTOR).clientHeight}px`,\r\n      'z-index: 9000',\r\n      'padding: 5px 8px',\r\n      'border: 1px solid #999',\r\n      'font-size: medium',\r\n      'color: var(--yt-primary-text-color)',\r\n      'margin: 0',\r\n      'box-sizing: border-box',\r\n      'background: var(--yt-main-app-background-tmp)'\r\n    ];\r\n    const txtSearch = util.makeElem('input', {\r\n      type: 'text',\r\n      placeholder: 'filter - start with ^ for inverse search',\r\n      style: [\r\n        ...commonStyles,\r\n        'right: 0',\r\n        'width: 300px'\r\n      ].join(';'),\r\n      onkeyup: util.debounce(e => resultCount.render(...yps.search(e.target.value)), 200)\r\n    });\r\n    const resultCount = util.makeElem('span', {\r\n      style: [\r\n        ...commonStyles,\r\n        'right: 300px'\r\n      ].join(';'),\r\n      textContent: '-'\r\n    });\r\n    resultCount.render = (x, y, invert) => resultCount.childNodes[0].textContent = `Showing ${x} of ${y} ${invert ? '(NOT)' : ''} | Hide Watched `;\r\n    const toggleWatched = util.makeElem('input', {\r\n      type: 'checkbox',\r\n      value: yps.hideWatched,\r\n      onchange: () => (yps.hideWatched = toggleWatched.checked, resultCount.render(...yps.search(txtSearch.value)))\r\n    });\r\n    resultCount.appendChild(toggleWatched);\r\n    [txtSearch, resultCount].forEach(elem => document.body.appendChild(elem));\r\n    return { txtSearch, resultCount };\r\n  },\r\n  search: (query = '') => {\r\n    const invert = query.startsWith('^');\r\n    if(invert) query = query.slice(1);\r\n    query = query.toLowerCase().trim().split(' ').map(q => q.trim()).filter(q => !!q);\r\n    const count = yps._items\r\n      .map(item => {\r\n        const hideBecauseWatched = yps.hideWatched && item.watched;\r\n        let hide = hideBecauseWatched || !query[invert ? 'some' : 'every'](q => item.name.includes(q));\r\n        if(invert && !hideBecauseWatched) hide = !hide;\r\n        item.elem.style.display = hide ? 'none' : '';\r\n        return hide;\r\n      })\r\n      .filter(hide => !hide).length;\r\n    return [count, yps._items.length, invert];\r\n  },\r\n  start: () => {\r\n    util.log('Starting... waiting for playlist');\r\n    waitForUrl(/^https:\\/\\/www\\.youtube\\.com\\/(playlist\\?list=|(user|channel)\\/[^\\/]+\\/videos|feed\\/subscriptions).*/, () => {\r\n      util.log('Reached playlist, adding search box');\r\n      const playlistUrl = location.href;\r\n      const { txtSearch, resultCount } = yps.render();\r\n      const refresh = util.debounce(() => resultCount.render(...yps.search(txtSearch.value)), 50);\r\n      const itemWait = waitForElems({\r\n        sel: ITEM_SELECTOR, \r\n        onmatch: elem => {\r\n          yps._items.push({\r\n            elem,\r\n            name: util.q(TEXT_SELECTOR, elem).textContent.toLowerCase(),\r\n            watched: false\r\n          });\r\n          refresh();\r\n        }\r\n      });\r\n      const progressWait = waitForElems({\r\n        sel: ITEM_PROGRESS_SELECTOR, \r\n        onmatch: prog => {\r\n          const watched = parseInt(prog.style.width) > 50;\r\n          if(!watched) return;\r\n          const itemElem = prog.closest(ITEM_SELECTOR);\r\n          const found = yps._items.find(item => item.elem === itemElem);\r\n          if(!found) return console.log('error, unable to find item parent', prog, itemElem, found);\r\n          found.watched = watched;\r\n          if(yps.hideWatched && watched) refresh();\r\n        }\r\n      });\r\n      const urlWaitId = waitForUrl(url => url !== playlistUrl, () => {\r\n        util.log('leaving playlist, cleaning up');\r\n        [progressWait, itemWait, urlWaitId].forEach(wait => wait.stop && wait.stop() || clearInterval(wait));\r\n        [txtSearch, resultCount].forEach(elem => elem.remove());\r\n        yps._items = [];\r\n      }, true);\r\n    });\r\n  }\r\n};\r\n\r\nyps.start();\r\n"],"names":["SCRIPT_NAME","ITEM_SELECTOR","ITEM_PROGRESS_SELECTOR","TEXT_SELECTOR","OFFSET_AREA_SELECTOR","util","log","_console","_len","arguments","length","args","Array","_key","console","apply","concat","q","query","context","document","querySelector","qq","from","querySelectorAll","debounce","cb","ms","id","_len2","_key2","clearTimeout","setTimeout","makeElem","tag","attrs","elem","createElement","Object","entries","forEach","_ref","_ref2","_slicedToArray","attr","val","includes","setAttribute","yps","_items","hideWatched","render","commonStyles","clientHeight","txtSearch","type","placeholder","style","join","onkeyup","e","_resultCount","resultCount","_toConsumableArray","search","target","value","textContent","x","y","invert","childNodes","toggleWatched","onchange","_resultCount2","checked","appendChild","body","undefined","startsWith","slice","toLowerCase","trim","split","map","filter","count","item","hideBecauseWatched","watched","hide","name","display","start","waitForUrl","playlistUrl","location","href","_yps$render","refresh","itemWait","waitForElems","sel","onmatch","push","progressWait","prog","parseInt","width","itemElem","closest","found","find","urlWaitId","url","wait","stop","clearInterval","remove"],"sourceRoot":""}